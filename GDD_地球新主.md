# 地球新主（Earth Lord）游戏设计文档（GDD）

## 文档信息
- **游戏名称**: 地球新主（Earth Lord）
- **类型**: LBS生存策略游戏
- **平台**: iOS
- **版本**: 1.0
- **文档日期**: 2025-12-23

---

## 第一章：游戏概述

### 1.1 高概念（High Concept）
在末日废土中，用双脚丈量土地，用智慧重建文明。这是一款结合真实地理位置的生存策略游戏，玩家通过实际行走圈地、探索搜刮、建造发展，在废墟之上书写属于自己的开拓传奇。

### 1.2 核心体验
- **圈地的成就感**: 用自己的脚步在真实世界画出属于自己的领地
- **探索的惊喜感**: 在熟悉的城市中发现"废墟"和"宝藏"
- **生存的紧迫感**: 资源会消耗，不探索就会死亡
- **社交的归属感**: 与附近的开拓者交易、交流、组建联盟

### 1.3 视觉风格
**"希望朋克"（Hopepunk）**
- 废土之上的绿色生机
- 破败建筑上的新生标志
- 末日美学与希望元素的结合
- 卫星地图叠加废土滤镜

### 1.4 核心循环
```
登录 → 圈地 → 探索 → 搜刮 → 获得资源
                              ↓
        ┌──────────────────────┤
        ↓                      ↓
    建造建筑              生存消耗
    (消耗资源)           (食物/水)
        ↓                      ↓
    交易换物              需要更多资源
    (流通资源)                 ↓
        ↓                      │
    通讯社交 ←─────────────────┘
        ↓
    成就排行 → 持续发展 → 更多圈地...
```

---

## 第二章：世界观与叙事

### 2.1 背景故事

#### 2.1.1 大事件时间线
| 时间 | 事件 |
|------|------|
| 2048年 | "终末战争"爆发，全球文明在72小时内崩塌 |
| 2048-2051年 | 黑暗时期，99%人口消失，幸存者躲藏 |
| 2051年 | 《新开拓者协议》颁布，重建时代开始 |
| 2051年+ | 玩家作为开拓者，开始重建文明 |

#### 2.1.2 核心设定
**《新开拓者协议》核心条款**：
> "凡以双足丈量之无主土地，皆为开拓者所有。"

这是新世界的基本法则：
- 旧世界的土地所有权已失效
- 想要拥有土地，必须亲自用脚步丈量
- 土地需要持续经营，否则会被回收

#### 2.1.3 世界氛围
- **废墟与重生**: 城市变成废墟，但生命顽强生长
- **秩序重建**: 开拓者们建立新的社会规则
- **希望主题**: 不是绝望的末日，而是重建的开始

### 2.2 玩家角色

#### 2.2.1 角色定位
玩家扮演一名**开拓者**（Pioneer），是终末战争后的幸存者，响应《新开拓者协议》，开始在废土上建立自己的家园。

#### 2.2.2 角色成长
| 等级 | 称号 | 解锁内容 |
|------|------|----------|
| 1-5 | 新手开拓者 | 基础功能 |
| 6-15 | 幸存者 | 更多建筑、交易功能 |
| 16-30 | 定居者 | 频道功能、联盟 |
| 31-50 | 领主 | 高级建筑、卫星通讯 |
| 51+ | 传奇开拓者 | 特殊成就、专属标识 |

---

## 第三章：核心玩法设计

### 3.1 圈地系统

#### 3.1.1 玩法描述
玩家在现实世界中行走，游戏记录GPS轨迹。当玩家绕行一圈回到起点时，轨迹闭合形成多边形，该区域成为玩家的领地。

#### 3.1.2 操作流程
1. 打开游戏，查看卫星地图
2. 点击"开始圈地"按钮
3. 在现实中开始行走
4. 观察地图上的蓝色轨迹线
5. 绕行一圈，返回起点附近（约20米范围）
6. 系统自动闭合多边形
7. 验证通过后，领地归属玩家

#### 3.1.3 规则限制
| 规则 | 描述 |
|------|------|
| 最小面积 | 500平方米 |
| 最大面积 | 单次圈地不超过50,000平方米 |
| 重叠检测 | 不可与他人领地重叠 |
| 作弊检测 | 检测GPS欺骗、速度异常 |
| 活跃要求 | 30天内开始建设，90天保持活跃 |

#### 3.1.4 反馈设计
- **轨迹颜色**: 蓝色（进行中）→ 绿色（闭合成功）
- **音效**: 脚步声、闭合成功音效
- **数据展示**: 实时显示已行走距离、预估面积

### 3.2 探索搜刮系统

#### 3.2.1 POI（兴趣点）发现
游戏使用苹果地图的真实POI数据，当玩家靠近真实地点时，游戏将其转化为"废墟"。

#### 3.2.2 POI类型与资源
| POI类型 | 游戏化名称 | 产出资源 | 搜刮CD |
|---------|------------|----------|--------|
| 医院/药店 | 废弃诊所 | 药品、急救包 | 4小时 |
| 超市/餐厅 | 废弃商铺 | 罐头、饮用水 | 2小时 |
| 工厂/工地 | 废弃工厂 | 金属、零件 | 6小时 |
| 公园/林地 | 荒野绿洲 | 木材、植物 | 3小时 |
| 银行/珠宝店 | 废弃金库 | 稀有材料 | 12小时 |
| 加油站 | 废弃油站 | 燃料 | 8小时 |
| 学校/图书馆 | 废弃学堂 | 技术图纸 | 6小时 |

#### 3.2.3 搜刮机制
```
触发条件: 进入POI 50米范围
    ↓
显示发现提示
    ↓
点击"搜刮"按钮
    ↓
播放搜刮动画（2-3秒）
    ↓
展示获得物品
    ↓
记录探索成就
    ↓
POI进入冷却
```

#### 3.2.4 探索统计
- 总探索距离（km）
- 探索时长（分钟）
- 发现POI数量
- 搜刮次数

### 3.3 建造系统

#### 3.3.1 建筑等级体系
| 等级 | 名称 | 解锁条件 | 建筑类型 |
|------|------|----------|----------|
| Tier 1 | 生存基础 | 初始解锁 | 篝火、简易帐篷、小仓库 |
| Tier 2 | 功能扩展 | 领地面积≥5000m² | 农田、工作台、中仓库 |
| Tier 3 | 高级设施 | 领地面积≥20000m² | 太阳能板、风力发电、大仓库 |

#### 3.3.2 建筑数据表
| 建筑 | 分类 | 所需资源 | 功能 | 建造时间 |
|------|------|----------|------|----------|
| 篝火 | 生存 | 石头×20, 木材×30 | 取暖、照明 | 10分钟 |
| 简易帐篷 | 生存 | 布料×15, 木材×20 | 休息恢复 | 30分钟 |
| 小仓库 | 储存 | 木材×50, 金属×20 | +50背包容量 | 1小时 |
| 中仓库 | 储存 | 木材×100, 金属×50 | +100背包容量 | 2小时 |
| 农田 | 生产 | 种子×10, 工具×5 | 生产食物 | 4小时 |
| 工作台 | 生产 | 金属×40, 工具×10 | 制作物品 | 2小时 |
| 太阳能板 | 能源 | 稀有材料×20, 金属×30 | 提供电力 | 6小时 |
| 风力发电机 | 能源 | 稀有材料×30, 金属×50 | 提供电力 | 8小时 |

#### 3.3.3 建筑状态机
```
┌─────────┐    建造完成    ┌─────────┐    激活    ┌─────────┐
│ 建造中  │ ───────────→ │ 待激活  │ ────────→ │ 运行中  │
└─────────┘              └─────────┘            └─────────┘
                                                    │
                              ┌─────────┐     损坏  │
                              │  损坏   │ ←────────┘
                              └─────────┘
                                  │ 修复
                                  ↓
                              ┌─────────┐
                              │ 运行中  │
                              └─────────┘
```

### 3.4 生存体征系统

#### 3.4.1 核心数值
| 数值 | 范围 | 衰减速度 | 低于阈值后果 |
|------|------|----------|--------------|
| 核心生命 | 0-100 | 被动衰减 | =0死亡 |
| 饱食度 | 0-100% | -5/小时 | <20%掉血 |
| 水分 | 0-100% | -10/小时 | <20%掉血 |

#### 3.4.2 增益机制
| 条件 | 增益效果 |
|------|----------|
| 饱食度≥80% | 探索效率+10% |
| 水分≥80% | 移动速度+10% |
| 两者都≥80% | 搜刮产出+20% |
| 两者都<20% | 无法圈地 |

#### 3.4.3 恢复方式
| 物品 | 恢复效果 |
|------|----------|
| 罐头食品 | 饱食度+30 |
| 饮用水 | 水分+40 |
| 急救包 | 生命+20 |
| 野果 | 饱食度+10 |
| 能量棒 | 饱食度+20, 水分+10 |

### 3.5 交易系统

#### 3.5.1 交易模式
采用**以物易物**的挂单模式，没有统一货币。

#### 3.5.2 交易流程
```
卖家: 发布挂单
  - 设置"我提供": 罐头×10
  - 设置"我需要": 药品×5
  - 开启领地"允许交易"
      ↓
买家: 进入卖家领地100米范围
      ↓
买家: 查看挂单列表
      ↓
买家: 选择合适挂单，点击"接受交易"
      ↓
系统: 检查双方物品
      ↓
系统: 执行交换
      ↓
双方: 收到交易成功通知
```

#### 3.5.3 交易限制
- 必须进入对方领地100米范围
- 单次交易上限：50件物品
- 交易冷却：同一玩家间隔30分钟

### 3.6 通讯系统

#### 3.6.1 设备升级路线
```
收音机（初始）
  ↓ 消耗: 金属×50, 零件×20
对讲机
  ↓ 消耗: 金属×100, 稀有材料×10
营地电台
  ↓ 消耗: 稀有材料×50, 高级零件×20
卫星通讯
```

#### 3.6.2 设备能力对比
| 设备 | 收听 | 发送 | 范围 | 功能 |
|------|------|------|------|------|
| 收音机 | O | X | 3km | 仅接收公共广播 |
| 对讲机 | O | O | 3km | 公共频道聊天 |
| 营地电台 | O | O | 10km | 创建/加入频道 |
| 卫星通讯 | O | O | 全球 | 全球联盟通讯 |

#### 3.6.3 频道类型
| 类型 | 描述 | 创建条件 |
|------|------|----------|
| 公共频道 | 范围内所有人可见 | 系统预设 |
| 交易频道 | 发布交易信息 | 系统预设 |
| 私人频道 | 用户创建的频道 | 营地电台 |
| 联盟频道 | 联盟专属通讯 | 联盟功能 |

#### 3.6.4 PTT（Push-to-Talk）
模拟真实对讲机体验：
- 长按麦克风按钮开始录音
- 松开按钮发送语音
- 显示当前频率（如438.000）
- 模拟无线电杂音效果

---

## 第四章：经济系统

### 4.1 资源体系

#### 4.1.1 资源分类
| 分类 | 资源 | 获取方式 | 主要用途 |
|------|------|----------|----------|
| 基础材料 | 木材、石头 | 探索、生产 | 建筑建造 |
| 金属材料 | 金属、零件 | 工厂POI | 高级建筑、设备 |
| 生存物资 | 食物、水 | 超市POI | 维持生存体征 |
| 医疗物资 | 药品、急救包 | 医院POI | 恢复生命值 |
| 稀有材料 | 稀有金属、芯片 | 特殊POI、交易 | 高级设备 |

#### 4.1.2 资源流动图
```
探索搜刮 ──→ 背包 ──→ 建造消耗
                │
                ↓
            交易流通
                │
                ↓
            生存消耗
```

### 4.2 付费设计

#### 4.2.1 订阅制
| 订阅 | 价格 | 权益 |
|------|------|------|
| 开拓者月卡 | $9.99/月 | 探索无CD、范围×2、专属标识 |
| 领主通行证 | $19.99/月 | 月卡权益+每日资源包+VIP频道 |

#### 4.2.2 一次性购买
| 商品 | 价格 | 内容 |
|------|------|------|
| 初级物资包 | $0.99 | 食物×50, 水×50 |
| 中级物资包 | $2.99 | 食物×150, 水×150, 药品×30 |
| 稀有资源包 | $9.99 | 稀有材料×20, 高级零件×10 |
| 新手礼包 | $4.99 | 综合物资+建筑加速 |

#### 4.2.3 付费点设计原则
- **不卖数值**: 付费不能直接购买领地、跳过圈地
- **卖便利**: 加速、扩容、减少重复劳动
- **卖外观**: 领地皮肤、专属标识
- **卖社交**: VIP频道、专属表情

---

## 第五章：社交系统

### 5.1 社交功能

#### 5.1.1 基础社交
| 功能 | 描述 |
|------|------|
| 玩家档案 | 查看其他玩家的等级、领地、成就 |
| 好友系统 | 添加好友、查看在线状态 |
| 访问领地 | 进入他人领地范围后可查看 |

#### 5.1.2 高级社交
| 功能 | 解锁条件 | 描述 |
|------|----------|------|
| 创建频道 | 营地电台 | 创建私人聊天频道 |
| 组建联盟 | 等级≥16 | 多人协作开发大型领地 |
| 联盟战争 | 联盟功能 | 联盟间的领地争夺（v2.0规划） |

### 5.2 排行榜

#### 5.2.1 榜单类型
| 榜单 | 排名依据 | 刷新频率 |
|------|----------|----------|
| 领地面积榜 | 总领地面积 | 5分钟 |
| 探索废墟榜 | 探索次数 | 5分钟 |
| 建筑数量榜 | 建筑总数 | 5分钟 |
| 存活天数榜 | 存活时长 | 每日 |

#### 5.2.2 排行激励
- 前10名：专属称号
- 前100名：每周奖励
- 进入榜单：成就徽章

### 5.3 成就系统

#### 5.3.1 成就分类
| 分类 | 示例 | 目的 |
|------|------|------|
| 新手成就 | 第一次圈地、第一次搜刮 | 引导学习 |
| 进阶成就 | 领地超过10000m²、建造10个建筑 | 中期目标 |
| 稀有成就 | 连续登录30天、探索100个POI | 长期留存 |
| 隐藏成就 | 特定条件触发 | 惊喜发现 |

#### 5.3.2 成就稀有度
| 稀有度 | 颜色 | 奖励倍率 |
|--------|------|----------|
| 普通 | 灰色 | 1x |
| 稀有 | 蓝色 | 2x |
| 史诗 | 紫色 | 5x |
| 传说 | 金色 | 10x |

---

## 第六章：游戏平衡

### 6.1 数值平衡

#### 6.1.1 资源产出与消耗
| 项目 | 数值 |
|------|------|
| 平均每次搜刮产出 | 10-30单位 |
| 建筑平均消耗 | 50-200单位 |
| 每小时生存消耗 | 饱食度-5, 水分-10 |
| 食物平均恢复 | 20-40单位 |

#### 6.1.2 预期游玩节奏
| 时间 | 预期进度 |
|------|----------|
| 第1天 | 完成第一次圈地，建造篝火 |
| 第3天 | 拥有500-2000m²领地，熟悉探索 |
| 第7天 | 拥有5000m²+领地，Tier 2建筑 |
| 第30天 | 多块领地，参与交易和社交 |

### 6.2 防作弊机制

| 作弊类型 | 检测方式 | 惩罚 |
|----------|----------|------|
| GPS欺骗 | 速度异常、位置跳变 | 领地作废 |
| 多开刷资源 | 设备指纹、行为分析 | 封号 |
| 交易刷单 | 频率检测、关系图谱 | 交易冻结 |

---

## 第七章：UI/UX设计

### 7.1 主界面布局
```
┌─────────────────────────────────┐
│         卫星地图视图             │
│   [玩家位置蓝点]                 │
│   [领地多边形-绿色]              │
│   [POI标记点]                    │
│                                 │
│   ┌─────┐                       │
│   │圈地 │  <-- 悬浮按钮         │
│   └─────┘                       │
├─────────────────────────────────┤
│  地图  │ 背包 │ 建造 │ 通讯 │ 个人│
└─────────────────────────────────┘
```

### 7.2 视觉风格指南
- **主色调**: 废土棕 + 希望绿
- **强调色**: 橙色（警告）、蓝色（信息）
- **字体**: 现代无衬线体
- **图标风格**: 线性图标 + 废土质感

### 7.3 音效设计
| 场景 | 音效 |
|------|------|
| 行走圈地 | 脚步声、沙沙声 |
| 闭合成功 | 胜利音效 |
| 搜刮 | 翻找声、发现音效 |
| 建造完成 | 建造音效 |
| 生存警告 | 紧迫警报 |
| 收到消息 | 无线电杂音 |

---

## 第八章：技术实现要点

### 8.1 核心技术挑战

| 挑战 | 解决方案 |
|------|----------|
| GPS精度 | 卡尔曼滤波平滑轨迹 |
| 多边形计算 | PostGIS地理空间数据库 |
| 实时通讯 | Supabase Realtime |
| 离线支持 | 本地优先架构 + 同步队列 |
| 大规模排行榜 | 数据库窗口函数 + 缓存 |

### 8.2 性能指标
| 指标 | 目标值 |
|------|--------|
| GPS采样频率 | 1Hz |
| 地图加载时间 | <2秒 |
| 消息延迟 | <1秒 |
| 电池消耗 | <10%/小时 |
| 流量消耗 | <50MB/小时 |

---

## 第九章：运营策略

### 9.1 每日任务
| 任务 | 奖励 |
|------|------|
| 行走1000步 | 食物×10 |
| 探索1个POI | 随机资源 |
| 发送1条消息 | 金币×50 |

### 9.2 活动规划
| 活动类型 | 频率 | 内容 |
|----------|------|------|
| 周末探索 | 每周 | 双倍搜刮产出 |
| 月度圈地 | 每月 | 圈地面积排名奖励 |
| 节日活动 | 节假日 | 限定资源、主题皮肤 |

### 9.3 新手引导
1. 强制教程：第一次登录引导完成圈地
2. 成就引导：用成就引导尝试各功能
3. 消息引导：通过"生存指南"消息教学

---

## 附录A：数据表汇总

### A.1 物品数据表
| 物品ID | 名称 | 类型 | 堆叠上限 |
|--------|------|------|----------|
| ITEM_001 | 木材 | 材料 | 999 |
| ITEM_002 | 石头 | 材料 | 999 |
| ITEM_003 | 金属 | 材料 | 500 |
| ITEM_004 | 罐头 | 食物 | 200 |
| ITEM_005 | 饮用水 | 食物 | 200 |
| ITEM_006 | 药品 | 医疗 | 100 |
| ITEM_007 | 急救包 | 医疗 | 50 |
| ITEM_008 | 稀有材料 | 稀有 | 100 |
| ITEM_009 | 布料 | 材料 | 500 |
| ITEM_010 | 零件 | 材料 | 200 |

### A.2 建筑数据表
| 建筑ID | 名称 | 等级 | 所需资源 | 建造时间 |
|--------|------|------|----------|----------|
| BUILD_001 | 篝火 | T1 | 石头×20, 木材×30 | 600秒 |
| BUILD_002 | 简易帐篷 | T1 | 布料×15, 木材×20 | 1800秒 |
| BUILD_003 | 小仓库 | T1 | 木材×50, 金属×20 | 3600秒 |
| BUILD_004 | 农田 | T2 | 种子×10, 工具×5 | 14400秒 |
| BUILD_005 | 工作台 | T2 | 金属×40, 工具×10 | 7200秒 |
| BUILD_006 | 太阳能板 | T3 | 稀有材料×20, 金属×30 | 21600秒 |

### A.3 成就数据表
| 成就ID | 名称 | 条件 | 稀有度 | 奖励 |
|--------|------|------|--------|------|
| ACH_001 | 新手领主 | 完成第一次圈地 | 普通 | 金币×100 |
| ACH_002 | 末世拾荒者 | 完成第一次搜刮 | 普通 | 金币×100 |
| ACH_003 | 小有家业 | 领地超过10000m² | 稀有 | 金币×500 |
| ACH_004 | 建筑大师 | 建造10个建筑 | 稀有 | 金币×500 |
| ACH_005 | 百日幸存者 | 存活100天 | 史诗 | 金币×2000 |
| ACH_006 | 传奇开拓者 | 全成就达成 | 传说 | 专属称号 |

---

## 附录B：核心代码模块

| 模块 | 文件 | 职责 |
|------|------|------|
| 用户认证 | AuthManager.swift | 登录、注册、会话管理 |
| 位置服务 | LocationManager.swift | GPS定位、轨迹记录 |
| 领地管理 | TerritoryManager.swift | 领地创建、存储、查询 |
| POI管理 | POIManager.swift | POI发现、地理围栏 |
| 探索系统 | ExplorationManager.swift | 搜刮逻辑、探索统计 |
| 物品管理 | ItemManager.swift | 背包、物品增删 |
| 建造系统 | BuildingManager.swift | 建筑创建、状态管理 |
| 交易系统 | TradeManager.swift | 挂单、交易撮合 |
| 通讯系统 | RadioManager.swift | 消息中心 |
| 通讯系统 | CommunicationManager.swift | 实时聊天 |
| 通讯系统 | ChannelManager.swift | 频道管理 |
| 内购支付 | StoreKitManager.swift | 订阅、购买 |
| 排行榜 | LeaderboardManager.swift | 排名计算、展示 |
| 成就系统 | AchievementManager.swift | 成就检测、发放 |
| 生存体征 | VitalSignsManagerV2.swift | 数值衰减、恢复 |

---

**文档结束**

> "在废墟之上，用双脚开拓新的家园。" —— 《新开拓者协议》
